# è´å¶æ–¯ä¼˜åŒ– - ç»ˆç«¯æ“ä½œè¯¦ç»†æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [å‰ç½®å‡†å¤‡](#å‰ç½®å‡†å¤‡)
2. [è¿è¡Œä¼˜åŒ–](#è¿è¡Œä¼˜åŒ–)
3. [å®æ—¶ç›‘æ§](#å®æ—¶ç›‘æ§)
4. [æŸ¥çœ‹ç»“æœ](#æŸ¥çœ‹ç»“æœ)
5. [åº”ç”¨å‚æ•°](#åº”ç”¨å‚æ•°)
6. [å¸¸è§é”™è¯¯å¤„ç†](#å¸¸è§é”™è¯¯å¤„ç†)

---

## å‰ç½®å‡†å¤‡

### æ­¥éª¤1: è¿›å…¥é¡¹ç›®ç›®å½•

```bash
cd /home/wlwang/sq/CDFS-D2AFC-2026-main
```

### æ­¥éª¤2: æ£€æŸ¥ç¯å¢ƒ

```bash
# å®‰è£…å¿…è¦çš„ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
pip install optuna matplotlib

# æµ‹è¯•ç¯å¢ƒæ˜¯å¦æ­£å¸¸
python test_bayesian_setup.py
```

**æœŸæœ›è¾“å‡º**:
```
================================================================================
æµ‹è¯•æ‘˜è¦
================================================================================

æ€»æµ‹è¯•: 6
é€šè¿‡: 6
å¤±è´¥: 0

âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼å¯ä»¥å¼€å§‹è¿è¡Œè´å¶æ–¯ä¼˜åŒ–
```

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œå…ˆè§£å†³æŠ¥é”™å†ç»§ç»­ã€‚

---

## è¿è¡Œä¼˜åŒ–

### æ–¹æ³•1: ä½¿ç”¨Pythonç›´æ¥è¿è¡Œï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰

#### å¿«é€Ÿæµ‹è¯•ï¼ˆ10æ¬¡è¯•éªŒï¼Œçº¦3å°æ—¶ï¼‰

```bash
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 10
```

#### æ ‡å‡†ä¼˜åŒ–ï¼ˆ50æ¬¡è¯•éªŒï¼Œçº¦16-20å°æ—¶ï¼‰

```bash
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50
```

#### å…¶ä»–æ•°æ®é›†

```bash
# GF50525
python bayesian_tuning_universal.py --config ./config/GF5-0525.py --n_trials 50

# Indian Pines
python bayesian_tuning_universal.py --config ./config/IP.py --n_trials 50

# Houston
python bayesian_tuning_universal.py --config ./config/houston.py --n_trials 50
```

### æ–¹æ³•2: åå°è¿è¡Œï¼ˆæ¨èç”¨äºé•¿æ—¶é—´ä¼˜åŒ–ï¼‰

```bash
# åå°è¿è¡Œï¼Œè¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶
nohup python bayesian_tuning_universal.py \
    --config ./config/GF5-1105.py \
    --n_trials 50 \
    > optimization.log 2>&1 &

# è®°ä¸‹è¿›ç¨‹ID
echo $!
```

**è·å–è¿›ç¨‹IDåçš„è¾“å‡ºç¤ºä¾‹**:
```
[1] 12345
12345
```

ä¿å­˜è¿™ä¸ªè¿›ç¨‹IDï¼ˆå¦‚12345ï¼‰ï¼Œåé¢å¯èƒ½éœ€è¦ç”¨åˆ°ã€‚

### æ–¹æ³•3: ä½¿ç”¨Shellè„šæœ¬

```bash
# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼ˆåªéœ€è¿è¡Œä¸€æ¬¡ï¼‰
chmod +x run_bayesian_tuning.sh

# è¿è¡Œè„šæœ¬
./run_bayesian_tuning.sh --n_trials 50

# æˆ–è€…åå°è¿è¡Œ
nohup ./run_bayesian_tuning.sh --n_trials 50 > optimization.log 2>&1 &
```

---

## å®æ—¶ç›‘æ§

### æ–¹æ³•1: æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼ˆå‰å°è¿è¡Œæ—¶ï¼‰

å¦‚æœä½¿ç”¨æ–¹æ³•2åå°è¿è¡Œï¼Œå¯ä»¥å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆæŒ‰Ctrl+Cé€€å‡ºï¼‰
tail -f optimization.log
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
Trial 0 - GF51105
================================================================================
è¶…å‚æ•°:
  lambda_weight: 0.2500
  mask_ratio: 0.8000
  weight_ctx: 2.5000
  weight_wd: 0.001000
  weight_disc: 1.5000
================================================================================

æ•°æ®é›† 1/2, ç§å­: 1236
  Episode 500/2000, Accuracy: 85.32%
  Episode 1000/2000, Accuracy: 87.15%
  Episode 1500/2000, Accuracy: 88.42%
  Episode 2000/2000, Accuracy: 88.91%
æ•°æ®é›† 1 æœ€ä½³å‡†ç¡®ç‡: 88.91%

æ•°æ®é›† 2/2, ç§å­: 1237
  Episode 500/2000, Accuracy: 85.67%
  ...

å¹³å‡å‡†ç¡®ç‡: 88.75%

Trial 0 å®Œæˆ, å‡†ç¡®ç‡: 88.75%
```

### æ–¹æ³•2: ä½¿ç”¨Pythonç›‘æ§å·¥å…·

**æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£**ï¼Œè¿è¡Œï¼š

```bash
cd /home/wlwang/sq/CDFS-D2AFC-2026-main

# å®æ—¶ç›‘æ§ï¼ˆæ¯30ç§’åˆ·æ–°ï¼‰
python view_optimization_results.py --latest --monitor
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
å®æ—¶ç›‘æ§æ¨¡å¼
================================================================================
æ•°æ®åº“: GF51105_bayesian_opt_20260202_143022.db
åˆ·æ–°é—´éš”: 30ç§’
æŒ‰ Ctrl+C é€€å‡º
================================================================================

[2026-02-02 14:35:22]
å®Œæˆçš„è¯•éªŒæ•°: 5
å½“å‰æœ€ä½³å‡†ç¡®ç‡: 89.24%

å½“å‰æœ€ä½³è¶…å‚æ•°:
  lambda_weight: 0.15
  mask_ratio: 0.80
  weight_ctx: 2.0
  weight_wd: 0.001234
  weight_disc: 1.2

æœ€è¿‘çš„è¯•éªŒ:
Trial    çŠ¶æ€       å‡†ç¡®ç‡      
----------------------------------------
0        COMPLETE   88.75%
1        COMPLETE   89.12%
2        COMPLETE   87.98%
3        COMPLETE   89.24%
4        RUNNING    N/A
```

### æ–¹æ³•3: æ£€æŸ¥è¿›ç¨‹çŠ¶æ€

```bash
# æ£€æŸ¥Pythonè¿›ç¨‹æ˜¯å¦è¿˜åœ¨è¿è¡Œ
ps aux | grep bayesian_tuning

# æ£€æŸ¥GPUä½¿ç”¨æƒ…å†µ
nvidia-smi

# æŸ¥çœ‹æœ€æ–°å‡ è¡Œæ—¥å¿—
tail -20 optimization.log
```

---

## æŸ¥çœ‹ç»“æœ

### åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­æŸ¥çœ‹

å³ä½¿ä¼˜åŒ–è¿˜åœ¨è¿›è¡Œï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹å½“å‰æœ€ä½³ç»“æœï¼š

```bash
# æŸ¥çœ‹æœ€æ–°studyçš„æ‘˜è¦
python view_optimization_results.py --latest
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
ä¼˜åŒ–Studyæ‘˜è¦
================================================================================

Studyåç§°: GF51105_bayesian_opt_20260202_143022
æ–¹å‘: æœ€å¤§åŒ–
å®Œæˆçš„è¯•éªŒæ•°: 23

è¯•éªŒçŠ¶æ€:
  å®Œæˆ: 23
  å‰ªæ: 0
  å¤±è´¥: 0
  è¿è¡Œä¸­: 0

æœ€ä½³è¯•éªŒ:
  Trialç¼–å·: 15
  å‡†ç¡®ç‡: 91.24%

æœ€ä½³è¶…å‚æ•°:
  lambda_weight: 0.15
  mask_ratio: 0.80
  weight_ctx: 2.0
  weight_wd: 0.001
  weight_disc: 1.0

Top 10 è¯•éªŒ:
Trial    å‡†ç¡®ç‡        lambda_w   mask_r     w_ctx      w_wd          w_disc    
--------------------------------------------------------------------------------
15       91.24        0.1500     0.8000     2.0000     0.001000      1.0000    
8        90.87        0.2000     0.8500     2.5000     0.000823      1.2000    
12       90.45        0.1000     0.7500     2.0000     0.001234      0.8000    
...
================================================================================
```

### ä¼˜åŒ–å®ŒæˆåæŸ¥çœ‹

#### 1. æŸ¥çœ‹æ‰€æœ‰ä¼˜åŒ–è®°å½•

```bash
# åˆ—å‡ºæ‰€æœ‰study
python view_optimization_results.py --list
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
å¯ç”¨çš„ä¼˜åŒ–Study
================================================================================

æ‰¾åˆ° 3 ä¸ªstudy:

1. GF51105_bayesian_opt_20260202_143022
   æ•°æ®åº“: GF51105_bayesian_opt_20260202_143022.db
   ä¿®æ”¹æ—¶é—´: 2026-02-02 18:45:30
   ç»“æœæ–‡ä»¶: GF51105_bayesian_opt_20260202_143022_results.json

2. IP_bayesian_opt_20260201_103015
   æ•°æ®åº“: IP_bayesian_opt_20260201_103015.db
   ä¿®æ”¹æ—¶é—´: 2026-02-01 15:20:10
   ç»“æœæ–‡ä»¶: IP_bayesian_opt_20260201_103015_results.json

3. GF50525_bayesian_opt_20260131_080000
   æ•°æ®åº“: GF50525_bayesian_opt_20260131_080000.db
   ä¿®æ”¹æ—¶é—´: 2026-01-31 12:30:45
```

#### 2. æŸ¥çœ‹è¯¦ç»†ç»“æœ

```bash
# æŸ¥çœ‹æœ€æ–°çš„study
python view_optimization_results.py --latest

# æŸ¥çœ‹æŒ‡å®šçš„study
python view_optimization_results.py --study GF51105_bayesian_opt_20260202_143022

# æ˜¾ç¤ºæ›´å¤šè¯•éªŒï¼ˆé»˜è®¤æ˜¾ç¤ºå‰10ä¸ªï¼‰
python view_optimization_results.py --latest --top 20
```

#### 3. æŸ¥çœ‹å‚æ•°é‡è¦æ€§

```bash
python view_optimization_results.py --latest --importance
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
å‚æ•°é‡è¦æ€§åˆ†æ
================================================================================

é‡è¦æ€§æ’åº:
1. weight_ctx          85.23% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
2. mask_ratio          72.15% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
3. weight_disc         58.42% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
4. lambda_weight       45.67% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
5. weight_wd           23.45% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
================================================================================
```

è¿™è¡¨ç¤º `weight_ctx` å¯¹ç»“æœå½±å“æœ€å¤§ã€‚

#### 4. å¯¼å‡ºç»“æœåˆ°CSV

```bash
# å¯¼å‡ºæ‰€æœ‰è¯•éªŒç»“æœ
python view_optimization_results.py --latest --export results.csv

# æŸ¥çœ‹å¯¼å‡ºçš„æ–‡ä»¶
cat results.csv
```

**CSVå†…å®¹ç¤ºä¾‹**:
```csv
trial_number,accuracy,lambda_weight,mask_ratio,weight_ctx,weight_wd,weight_disc
0,88.75,0.25,0.80,2.5,0.001,1.5
1,89.12,0.15,0.85,2.0,0.0008,1.2
2,87.98,0.30,0.75,3.0,0.0015,1.8
...
```

#### 5. ç›´æ¥æŸ¥çœ‹JSONç»“æœæ–‡ä»¶

```bash
# æ‰¾åˆ°æœ€æ–°çš„ç»“æœæ–‡ä»¶
ls -lt *_results.json | head -1

# æŸ¥çœ‹JSONæ–‡ä»¶å†…å®¹
cat GF51105_bayesian_opt_20260202_143022_results.json
```

**JSONå†…å®¹ç¤ºä¾‹**:
```json
{
    "dataset": "GF51105",
    "best_trial": 15,
    "best_accuracy": 91.24,
    "best_params": {
        "lambda_weight": 0.15,
        "mask_ratio": 0.8,
        "weight_ctx": 2.0,
        "weight_wd": 0.001,
        "weight_disc": 1.0
    },
    "study_name": "GF51105_bayesian_opt_20260202_143022",
    "n_trials": 50,
    "timestamp": "2026-02-02T18:45:30.123456"
}
```

æˆ–è€…ä½¿ç”¨æ›´å‹å¥½çš„æ ¼å¼ï¼š

```bash
python -m json.tool GF51105_bayesian_opt_20260202_143022_results.json
```

#### 6. æŸ¥çœ‹å¯è§†åŒ–å›¾è¡¨

```bash
# åˆ—å‡ºç”Ÿæˆçš„å›¾è¡¨
ls *_history.png *_importance.png

# ä½¿ç”¨å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€ï¼ˆæ ¹æ®ç³»ç»Ÿä¸åŒï¼‰
# Linux with display
display GF51105_bayesian_opt_20260202_143022_history.png

# æˆ–è€…ä½¿ç”¨å…¶ä»–å›¾ç‰‡æŸ¥çœ‹å™¨
eog GF51105_bayesian_opt_20260202_143022_history.png
```

---

## åº”ç”¨å‚æ•°

### æ­¥éª¤1: ç¡®è®¤æœ€ä½³å‚æ•°

```bash
# å†æ¬¡ç¡®è®¤æœ€ä½³å‚æ•°
python view_optimization_results.py --latest
```

è®°ä¸‹è¾“å‡ºçš„æœ€ä½³è¶…å‚æ•°ã€‚

### æ­¥éª¤2: è¿è¡Œåº”ç”¨å·¥å…·ï¼ˆäº¤äº’å¼ï¼‰

```bash
python apply_best_params.py
```

**äº¤äº’æµç¨‹**:
```
æŸ¥æ‰¾æœ€æ–°çš„ä¼˜åŒ–ç»“æœ...
æ‰¾åˆ°ç»“æœæ–‡ä»¶: GF51105_bayesian_opt_20260202_143022_results.json
åŠ è½½æœ€ä½³å‚æ•°...

================================================================================
æœ€ä½³å‡†ç¡®ç‡: 91.24%
æœ€ä½³è¶…å‚æ•°:
  lambda_weight: 0.15
  mask_ratio: 0.8
  weight_ctx: 2.0
  weight_wd: 0.001
  weight_disc: 1.0
================================================================================

æ˜¯å¦åº”ç”¨è¿™äº›å‚æ•°åˆ°è®­ç»ƒè„šæœ¬? (y/n): y

æ­£åœ¨æ›´æ–° automated_tuning.py...
å·²å¤‡ä»½åŸæ–‡ä»¶åˆ°: automated_tuning.py.backup_20260202_184530
âœ“ æˆåŠŸåº”ç”¨ 5 å¤„ä¿®æ”¹

================================================================================
è´å¶æ–¯ä¼˜åŒ–ç»“æœæŠ¥å‘Š
================================================================================

ä¼˜åŒ–ä¿¡æ¯:
  Studyåç§°: GF51105_bayesian_opt_20260202_143022
  å®Œæˆæ—¶é—´: 2026-02-02T18:45:30.123456
  è¯•éªŒæ¬¡æ•°: 50

æœ€ä½³ç»“æœ:
  Trialç¼–å·: 15
  å‡†ç¡®ç‡: 91.24%

æœ€ä½³è¶…å‚æ•°:
  lambda_weight:  0.1500
  mask_ratio:     0.8000
  weight_ctx:     2.0000
  weight_wd:      0.001000
  weight_disc:    1.0000

åº”ç”¨çš„ä¿®æ”¹:
  âœ“ ç¬¬205è¡Œ: lambda_weight: 0.0 -> 0.15
  âœ“ ç¬¬424è¡Œ: mask_ratio: 0.8 -> 0.8
  âœ“ ç¬¬426è¡Œ: mask_ratio: 0.8 -> 0.8
  âœ“ ç¬¬523è¡Œ: weight_ctx: 2.0 -> 2.0
  âœ“ ç¬¬523è¡Œ: weight_wd: 0.001 -> 0.001
  âœ“ ç¬¬523è¡Œ: weight_disc: 1.0 -> 1.0

ä¸‹ä¸€æ­¥:
  1. æ£€æŸ¥ä¿®æ”¹åçš„ automated_tuning.py æ–‡ä»¶
  2. è¿è¡Œå®Œæ•´è®­ç»ƒ: python automated_tuning.py
  3. å¦‚éœ€å›æ»šï¼Œä½¿ç”¨å¤‡ä»½æ–‡ä»¶
================================================================================
```

### æ­¥éª¤3: é¢„è§ˆä¿®æ”¹ï¼ˆä¸å®é™…åº”ç”¨ï¼‰

```bash
# ä»…æŸ¥çœ‹å°†è¦è¿›è¡Œçš„ä¿®æ”¹
python apply_best_params.py --dry_run
```

### æ­¥éª¤4: æ‰‹åŠ¨åº”ç”¨å‚æ•°

å¦‚æœä½ æƒ³æ‰‹åŠ¨ä¿®æ”¹ï¼Œå¯ä»¥ï¼š

```bash
# 1. å¤‡ä»½åŸæ–‡ä»¶
cp automated_tuning.py automated_tuning.py.backup

# 2. ç¼–è¾‘æ–‡ä»¶
nano automated_tuning.py
# æˆ–
vim automated_tuning.py

# 3. æ ¹æ®JSONä¸­çš„å‚æ•°æ‰‹åŠ¨ä¿®æ”¹ä»¥ä¸‹ä½ç½®ï¼š
#    - ç¬¬205è¡Œ: lambda_weight
#    - ç¬¬424ã€426è¡Œ: mask_ratio
#    - ç¬¬523è¡Œ: weight_ctx, weight_wd, weight_disc
```

### æ­¥éª¤5: ä½¿ç”¨æœ€ä½³å‚æ•°è¿›è¡Œå®Œæ•´è®­ç»ƒ

```bash
# è¿è¡Œå®Œæ•´è®­ç»ƒï¼ˆä½¿ç”¨æœ€ä½³å‚æ•°ï¼‰
python automated_tuning.py
```

---

## å¸¸è§é”™è¯¯å¤„ç†

### é”™è¯¯1: æ‰¾ä¸åˆ°ä¼˜åŒ–ç»“æœ

**é”™è¯¯ä¿¡æ¯**:
```
é”™è¯¯: æœªæ‰¾åˆ°ä¼˜åŒ–ç»“æœæ–‡ä»¶
è¯·å…ˆè¿è¡Œè´å¶æ–¯ä¼˜åŒ–: python bayesian_tuning_wrapper.py
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥æ˜¯å¦æœ‰ç»“æœæ–‡ä»¶
ls *_results.json

# å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜ä¼˜åŒ–è¿˜æœªè¿è¡Œæˆ–æœªå®Œæˆ
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 10
```

### é”™è¯¯2: è¿›ç¨‹è¢«æ€æ­»

**ç—‡çŠ¶**: æ—¥å¿—ä¸­æœ€åæ˜¾ç¤º "Killed"

**åŸå› **: é€šå¸¸æ˜¯å†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# 2. å‡å°batch sizeï¼ˆç¼–è¾‘bayesian_tuning_universal.pyï¼‰
#    æ‰¾åˆ°: batch_size=64
#    æ”¹ä¸º: batch_size=32

# 3. æˆ–è€…å…³é—­å…¶ä»–å ç”¨å†…å­˜çš„ç¨‹åº

# 4. é‡æ–°è¿è¡Œ
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50
```

### é”™è¯¯3: CUDA out of memory

**é”™è¯¯ä¿¡æ¯**:
```
RuntimeError: CUDA out of memory
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥GPUä½¿ç”¨æƒ…å†µ
nvidia-smi

# 2. å¦‚æœæœ‰å…¶ä»–è¿›ç¨‹å ç”¨GPUï¼Œå…ˆåœæ­¢å®ƒä»¬
kill <è¿›ç¨‹ID>

# 3. æˆ–è€…å‡å°batch size

# 4. æ¸…ç†GPUç¼“å­˜åé‡è¯•
python -c "import torch; torch.cuda.empty_cache()"
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50
```

### é”™è¯¯4: è¿›ç¨‹åœ¨åå°ä½†çœ‹ä¸åˆ°è¾“å‡º

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f optimization.log

# æˆ–è€…æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿˜åœ¨è¿è¡Œ
ps aux | grep bayesian

# å¦‚æœè¿›ç¨‹å­˜åœ¨ï¼ŒæŸ¥çœ‹å®ƒçš„è¾“å‡º
tail -100 optimization.log
```

### é”™è¯¯5: ä¼˜åŒ–ç»“æœä¸ç†æƒ³

**ç—‡çŠ¶**: ä¼˜åŒ–åå‡†ç¡®ç‡æå‡ä¸æ˜æ˜¾æˆ–åè€Œä¸‹é™

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ**:

1. **è¯•éªŒæ¬¡æ•°å¤ªå°‘**
```bash
# å¢åŠ è¯•éªŒæ¬¡æ•°
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 100
```

2. **è®­ç»ƒè½®æ¬¡å¤ªå°‘**
```bash
# ç¼–è¾‘ bayesian_tuning_universal.py
# æ‰¾åˆ°: max_episode=2000
# æ”¹ä¸º: max_episode=5000
```

3. **è¯„ä¼°ç§å­å¤ªå°‘**
```bash
# ç¼–è¾‘ bayesian_tuning_universal.py
# æ‰¾åˆ°: seeds=[1236, 1237]
# æ”¹ä¸º: seeds=[1236, 1237, 1230, 1238, 1211]
```

---

## å¿«é€Ÿå‘½ä»¤é€ŸæŸ¥è¡¨

```bash
# === åŸºæœ¬æ“ä½œ ===
# è¿›å…¥ç›®å½•
cd /home/wlwang/sq/CDFS-D2AFC-2026-main

# æµ‹è¯•ç¯å¢ƒ
python test_bayesian_setup.py

# è¿è¡Œä¼˜åŒ–
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50

# åå°è¿è¡Œ
nohup python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50 > opt.log 2>&1 &

# === ç›‘æ§ ===
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f optimization.log

# Pythonç›‘æ§å·¥å…·
python view_optimization_results.py --latest --monitor

# æ£€æŸ¥è¿›ç¨‹
ps aux | grep bayesian

# æ£€æŸ¥GPU
nvidia-smi

# === æŸ¥çœ‹ç»“æœ ===
# æŸ¥çœ‹æœ€æ–°ç»“æœ
python view_optimization_results.py --latest

# æŸ¥çœ‹æ‰€æœ‰study
python view_optimization_results.py --list

# æŸ¥çœ‹å‚æ•°é‡è¦æ€§
python view_optimization_results.py --latest --importance

# å¯¼å‡ºCSV
python view_optimization_results.py --latest --export results.csv

# æŸ¥çœ‹JSON
cat *_results.json | python -m json.tool

# === åº”ç”¨å‚æ•° ===
# äº¤äº’å¼åº”ç”¨
python apply_best_params.py

# é¢„è§ˆä¿®æ”¹
python apply_best_params.py --dry_run

# è¿è¡Œè®­ç»ƒ
python automated_tuning.py

# === åœæ­¢å’Œæ¸…ç† ===
# åœæ­¢åå°è¿›ç¨‹
kill <è¿›ç¨‹ID>

# å¼ºåˆ¶åœæ­¢
kill -9 <è¿›ç¨‹ID>

# æ¸…ç†GPUç¼“å­˜
python -c "import torch; torch.cuda.empty_cache()"
```

---

## å…¸å‹å·¥ä½œæµç¨‹ç¤ºä¾‹

### åœºæ™¯1: ç¬¬ä¸€æ¬¡è¿è¡Œï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰

```bash
# æ­¥éª¤1: è¿›å…¥ç›®å½•
cd /home/wlwang/sq/CDFS-D2AFC-2026-main

# æ­¥éª¤2: æµ‹è¯•ç¯å¢ƒ
python test_bayesian_setup.py

# æ­¥éª¤3: å¿«é€Ÿæµ‹è¯•ï¼ˆ10æ¬¡è¯•éªŒï¼‰
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 10

# æ­¥éª¤4: æŸ¥çœ‹ç»“æœ
python view_optimization_results.py --latest

# æ­¥éª¤5: å¦‚æœç»“æœåˆç†ï¼Œè¿è¡Œå®Œæ•´ä¼˜åŒ–
python bayesian_tuning_universal.py --config ./config/GF5-1105.py --n_trials 50
```

### åœºæ™¯2: é•¿æ—¶é—´åå°è¿è¡Œ

```bash
# æ­¥éª¤1: åå°è¿è¡Œ
cd /home/wlwang/sq/CDFS-D2AFC-2026-main
nohup python bayesian_tuning_universal.py \
    --config ./config/GF5-1105.py \
    --n_trials 50 \
    > optimization_gf51105.log 2>&1 &

# è®°å½•è¿›ç¨‹ID
OPTIM_PID=$!
echo "ä¼˜åŒ–è¿›ç¨‹ID: $OPTIM_PID"

# æ­¥éª¤2: å®šæœŸæ£€æŸ¥è¿›åº¦ï¼ˆåœ¨å¦ä¸€ä¸ªç»ˆç«¯ï¼‰
tail -f optimization_gf51105.log

# æˆ–ä½¿ç”¨ç›‘æ§å·¥å…·
python view_optimization_results.py --latest --monitor

# æ­¥éª¤3: ä¼˜åŒ–å®ŒæˆåæŸ¥çœ‹ç»“æœ
python view_optimization_results.py --latest --importance

# æ­¥éª¤4: åº”ç”¨æœ€ä½³å‚æ•°
python apply_best_params.py

# æ­¥éª¤5: å®Œæ•´è®­ç»ƒ
python automated_tuning.py
```

### åœºæ™¯3: å¤šæ•°æ®é›†æ‰¹é‡ä¼˜åŒ–

```bash
# æ­¥éª¤1: åˆ›å»ºæ‰¹å¤„ç†è„šæœ¬
cat > batch_optimize.sh << 'EOF'
#!/bin/bash
datasets=("GF5-1105" "GF5-0525" "IP")

for dataset in "${datasets[@]}"; do
    echo "=== å¼€å§‹ä¼˜åŒ–: $dataset ==="
    python bayesian_tuning_universal.py \
        --config ./config/${dataset}.py \
        --n_trials 30 \
        > logs_bayesian/optimize_${dataset}.log 2>&1
    echo "=== å®Œæˆ: $dataset ==="
done
EOF

chmod +x batch_optimize.sh

# æ­¥éª¤2: åå°è¿è¡Œæ‰¹å¤„ç†
nohup ./batch_optimize.sh > batch_all.log 2>&1 &

# æ­¥éª¤3: ç›‘æ§è¿›åº¦
tail -f batch_all.log

# æ­¥éª¤4: æŸ¥çœ‹æ‰€æœ‰ç»“æœ
python view_optimization_results.py --list

# æ­¥éª¤5: ä¸ºæ¯ä¸ªæ•°æ®é›†åº”ç”¨æœ€ä½³å‚æ•°
python view_optimization_results.py --study GF51105_bayesian_opt_*
python view_optimization_results.py --study GF50525_bayesian_opt_*
python view_optimization_results.py --study IP_bayesian_opt_*
```

---

å¸Œæœ›è¿™ä¸ªç»ˆç«¯æ“ä½œæŒ‡å—å¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœåœ¨å®é™…æ“ä½œä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥éšæ—¶é—®æˆ‘ã€‚ ğŸš€
